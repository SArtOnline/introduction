(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6dda5537"],{"0b47":function(e,t,o){"use strict";o.r(t);var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("page-header-wrapper",{attrs:{title:"JAVA文档","tab-list":e.tabList,"tab-active-key":e.tabActiveKey},on:{tabChange:e.handleTabChange},scopedSlots:e._u([{key:"content",fn:function(){return[o("a-descriptions",{attrs:{size:"small",column:e.isMobile?1:2}},[o("a-descriptions-item",{attrs:{label:"语雀文档"}},[o("a",{attrs:{href:"https://www.yuque.com/artonline/java/ng0wew",target:"_blank"}},[e._v("JAVA文档")])])],1)]},proxy:!0},{key:"extra",fn:function(){},proxy:!0}])},["threadPool"===e.tabActiveKey?o("div",[o("executor-service",{attrs:{id:"threadPool","thread-pool-config":e.threadPoolConfig}}),o("a-card",{staticStyle:{"margin-top":"24px"},attrs:{bordered:!1,title:"Executors提供4种线程池实现方案"}},[o("a-descriptions",{attrs:{size:"small"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("1、单例线程池 "),o("a-tag",[o("a",{attrs:{href:"#threadPool"},on:{click:function(t){return e.tryThreadPool({corePoolSize:1,maximumPoolSize:1,keepAliveTime:0})}}},[e._v("试一试")])])],1),o("a-descriptions-item",{attrs:{label:"",span:3}},[o("strong",[e._v("Executors.newSingleThreadExecutor()")]),e._v("：创建单例线程池，该线程池中同时在线的线程如其名只有一个，并且先入队先执行，也就是"),o("strong",[e._v("FIFO规则")]),e._v("。其线程池配置如下：")]),o("a-descriptions-item",{attrs:{label:"corePoolSize"}},[e._v("1")]),o("a-descriptions-item",{attrs:{label:"maximumPoolSize"}},[e._v("1")]),o("a-descriptions-item",{attrs:{label:"keepAliveTime"}},[e._v("0")]),o("a-descriptions-item",{attrs:{span:3}},[e._v("任务队列为链表"),o("strong",[e._v("LinkedBlockingQueue")]),e._v("，每次提交任务添加到队尾，消费队首任务。因此遵循"),o("strong",[e._v("FIFO规则")])])],1),o("a-descriptions",{attrs:{size:"small"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("2、定长线程池 "),o("a-tag",[o("a",{attrs:{href:"#threadPool"},on:{click:function(t){return e.tryThreadPool({corePoolSize:5,maximumPoolSize:5,keepAliveTime:0})}}},[e._v("试一试")])])],1),o("a-descriptions-item",{attrs:{label:"",span:3}},[o("strong",[e._v("Executors.newFixedThreadPool(n)")]),e._v("：创建定长线程池，该线程池只有核心任务池且同时运行的线程最大数量时确定的，其中corePoolSize与maximumPoolSize总是相等。其线程池配置如下：")]),o("a-descriptions-item",{attrs:{label:"corePoolSize"}},[e._v("n")]),o("a-descriptions-item",{attrs:{label:"maximumPoolSize"}},[e._v("n")]),o("a-descriptions-item",{attrs:{label:"keepAliveTime"}},[e._v("0")]),o("a-descriptions-item",{attrs:{span:3}},[e._v("任务队列为链表"),o("strong",[e._v("LinkedBlockingQueue")]),e._v("，每次提交任务添加到队尾，消费队首任务。因此遵循"),o("strong",[e._v("FIFO规则")])])],1),o("a-descriptions",{attrs:{size:"small"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("3、缓存线程池 "),o("a-tag",[o("a",{attrs:{href:"#threadPool"},on:{click:function(t){return e.tryThreadPool({corePoolSize:0,maximumPoolSize:20,keepAliveTime:6e4})}}},[e._v("试一试")])])],1),o("a-descriptions-item",{attrs:{label:"",span:3}},[o("strong",[e._v("Executors.newCachedThreadPool()")]),e._v("：创建缓存线程池，该线程池没有核心任务池，也就是说任务执行完成后，一定时间内没有提交其他任务将会回收内存资源，理论上任务数不受限制。其线程池配置如下：")]),o("a-descriptions-item",{attrs:{label:"corePoolSize"}},[e._v("0")]),o("a-descriptions-item",{attrs:{label:"maximumPoolSize"}},[e._v("∞")]),o("a-descriptions-item",{attrs:{label:"keepAliveTime"}},[e._v("60000")]),o("a-descriptions-item",{attrs:{span:3}},[e._v("任务队列为同步队列"),o("strong",[e._v("SynchronousQueue")]),e._v("，每次提交任务只有在任务被消费后，才能提交下次任务，该队列永远都保持1个任务或没有任务。此外线程池不限制数量，因此遵循"),o("strong",[e._v("提交即执行")]),e._v("。")])],1),o("a-descriptions",{attrs:{size:"small"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("4、定时线程池 "),o("a-tag",[o("a",{attrs:{href:"#threadPool"},on:{click:function(t){return e.tryThreadPool({corePoolSize:5,maximumPoolSize:20,keepAliveTime:6e4})}}},[e._v("试一试")])])],1),o("a-descriptions-item",{attrs:{label:"",span:3}},[o("strong",[e._v("Executors.newScheduledThreadPool(n)")]),e._v("：创建定时线程池，该线程池支持规划可重复利用的核心工作池，且不限制运行的任务数量。其线程池配置如下：")]),o("a-descriptions-item",{attrs:{label:"corePoolSize"}},[e._v("n")]),o("a-descriptions-item",{attrs:{label:"maximumPoolSize"}},[e._v("∞")]),o("a-descriptions-item",{attrs:{label:"keepAliveTime"}},[e._v("0")]),o("a-descriptions-item",{attrs:{span:3}},[e._v("任务队列为延迟队列"),o("strong",[e._v("DelayedWorkQueue")]),e._v("，该队列作用是延迟一段时间后，按优先队列方式消费任务，因此提交的任务不会立马执行，并且具有优先级。因此遵循"),o("strong",[e._v("延迟后优先级高即执行")]),e._v("。")])],1)],1)],1):e._e()])},a=[],i=o("432b"),n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("a-card",{attrs:{bordered:!1,title:"ThreadPoolExecutor动态演示"}},[o("a-badge",{attrs:{slot:"extra",count:e.count},slot:"extra"},[o("a-button",{attrs:{icon:"plus"},on:{click:e.addThread}},[e._v("添加线程")])],1),o("a-button",{staticStyle:{"margin-left":"10px"},attrs:{slot:"extra",type:"primary"},on:{click:e.execute},slot:"extra"},[e._v("execute")]),o("a-form",{attrs:{form:e.form}},[o("a-row",{attrs:{gutter:24}},[o("a-col",{attrs:{xs:7,md:7,lg:7}},[o("a-form-item",{attrs:{label:"corePoolSize"}},[o("a-input",{attrs:{type:"number",disabled:e.executeFlag},model:{value:e.threadPoolConfig.corePoolSize,callback:function(t){e.$set(e.threadPoolConfig,"corePoolSize",t)},expression:"threadPoolConfig.corePoolSize"}})],1)],1),o("a-col",{attrs:{xs:7,md:7,lg:7}},[o("a-form-item",{attrs:{label:"maximumPoolSize"}},[o("a-input",{attrs:{type:"number",disabled:e.executeFlag},model:{value:e.threadPoolConfig.maximumPoolSize,callback:function(t){e.$set(e.threadPoolConfig,"maximumPoolSize",t)},expression:"threadPoolConfig.maximumPoolSize"}})],1)],1),o("a-col",{attrs:{xs:7,md:7,lg:7}},[o("a-form-item",{attrs:{label:"keepAliveTime"}},[o("a-input",{attrs:{type:"number",disabled:e.executeFlag},model:{value:e.threadPoolConfig.keepAliveTime,callback:function(t){e.$set(e.threadPoolConfig,"keepAliveTime",t)},expression:"threadPoolConfig.keepAliveTime"}})],1)],1)],1),e.shutdown?e._e():o("a-row",{attrs:{gutter:24}},[o("a-col",{attrs:{xs:24,md:24,lg:24}},[o("a-form-item",{ref:"corePoolContainer",attrs:{label:"corePool"}},e._l(e.coreWorkers,(function(e,t){return o("a-progress",{key:"c"+t,attrs:{percent:e.percent,size:"small"}})})),1)],1),o("a-col",{attrs:{xs:24,md:24,lg:24}},[o("a-form-item",{ref:"otherContainer",attrs:{label:"maximumPool - corePool"}},e._l(e.maxWorkers,(function(e,t){return o("a-progress",{key:"m"+t,attrs:{percent:e.percent||0,size:"small"}})})),1)],1)],1)],1)],1)},s=[],l=(o("4de4"),o("a434"),o("8111"),{props:{threadPoolConfig:{type:Object,default:function(){return{corePoolSize:3,maximumPoolSize:5,keepAliveTime:1e3,timeUnit:"s",blockingQueue:[]}}}},data:function(){return{form:this.$form.createForm(),executeFlag:!1,count:0,workers:[],coreWorkers:[],maxWorkers:[]}},computed:{shutdown:function(){return 0===this.count&&0===this.workerCountOf()||0===this.workerCountOf()&&0===this.maxWorkers.length}},watch:{threadPoolConfig:{handler:function(e,t){e.corePoolSize>e.maximumPoolSize-0&&(this.$message.warning("corePoolSize不能大于maximumPoolSize"),this.threadPoolConfig.corePoolSize=this.threadPoolConfig.maximumPoolSize)},deep:!0},coreWorkers:{handler:function(e,t){var o=this;setTimeout((function(){for(var t=0;t<e.length;t++)e[t].percent>=100&&(o.coreWorkers[t].percent=0),0<e[t].percent&&e[t].percent<100&&(o.coreWorkers[t].percent=o.coreWorkers[t].percent+Math.ceil(3*Math.random()))}),1e3)},deep:!0},maxWorkers:{handler:function(e,t){var o=this;setTimeout((function(){for(var t=function(t){if(e[t].percent>=100){var r=setTimeout((function(){o.maxWorkers.splice(t,1)}),o.threadPoolConfig.keepAliveTime);return o.count>0&&(clearTimeout(r),o.maxWorkers[t].percent=0),"continue"}0<e[t].percent&&e[t].percent<100&&(o.maxWorkers[t].percent=o.maxWorkers[t].percent+Math.ceil(3*Math.random()))},r=0;r<e.length;r++)t(r)}),100)},deep:!0}},methods:{addThread:function(){this.count++,this.threadPoolConfig.blockingQueue.push({percent:1})},offer:function(){return this.threadPoolConfig.blockingQueue.pop()},addWorker:function(e){var t=this.offer();if(t)if(e){for(var o=0;o<this.coreWorkers.length;o++)if(0===this.coreWorkers[o].percent){this.coreWorkers[o].percent=1,this.count--;break}}else if(this.maxWorkers.length<this.threadPoolConfig.maximumPoolSize-this.threadPoolConfig.corePoolSize)this.maxWorkers.push(t),this.count--;else for(o=0;o<this.maxWorkers.length;o++)if(0===this.maxWorkers[o].percent){this.maxWorkers[o].percent=1,this.count--;break}},workerCountOf:function(){return this.coreWorkers.filter((function(e){return e.percent>0})).length},initPool:function(){for(var e=[],t=0;t<this.threadPoolConfig.corePoolSize;t++)e.push({percent:0});this.$set(this,"coreWorkers",e),this.$set(this,"maxWorkers",[])},execute:function(){this.executeFlag=!0,this.initPool();var e=this,t=setInterval((function(){e.workerCountOf()<e.threadPoolConfig.corePoolSize?e.addWorker(!0):e.maxWorkers.filter((function(e){return e.percent>0})).length<e.threadPoolConfig.maximumPoolSize-e.threadPoolConfig.corePoolSize&&e.addWorker(!1),e.count<=0&&(e.$set(e,"executeFlag",!1),clearInterval(t))}),500)}}}),c=l,u=o("2877"),m=Object(u["a"])(c,n,s,!1,null,null,null),d=m.exports,p={components:{ExecutorService:d},name:"Advanced",mixins:[i["a"]],data:function(){return{threadPoolConfig:{corePoolSize:3,maximumPoolSize:5,keepAliveTime:1e3,timeUnit:"s",blockingQueue:[]},tabList:[{key:"threadPool",tab:"线程池"},{key:"rule",tab:"规则"}],tabActiveKey:"threadPool",operationTabList:[{key:"1",tab:"操作日志一"},{key:"2",tab:"操作日志二"},{key:"3",tab:"操作日志三"}],operationActiveTabKey:"1",operationColumns:[{title:"操作类型",dataIndex:"type",key:"type"},{title:"操作人",dataIndex:"name",key:"name"},{title:"执行结果",dataIndex:"status",key:"status",scopedSlots:{customRender:"status"}},{title:"操作时间",dataIndex:"updatedAt",key:"updatedAt"},{title:"备注",dataIndex:"remark",key:"remark"}],operation1:[{key:"op1",type:"订购关系生效",name:"曲丽丽",status:"agree",updatedAt:"2017-10-03  19:23:12",remark:"-"},{key:"op2",type:"财务复审",name:"付小小",status:"reject",updatedAt:"2017-10-03  19:23:12",remark:"不通过原因"},{key:"op3",type:"部门初审",name:"周毛毛",status:"agree",updatedAt:"2017-10-03  19:23:12",remark:"-"},{key:"op4",type:"提交订单",name:"林东东",status:"agree",updatedAt:"2017-10-03  19:23:12",remark:"很棒"},{key:"op5",type:"创建订单",name:"汗牙牙",status:"agree",updatedAt:"2017-10-03  19:23:12",remark:"-"}],operation2:[{key:"op2",type:"财务复审",name:"付小小",status:"reject",updatedAt:"2017-10-03  19:23:12",remark:"不通过原因"},{key:"op3",type:"部门初审",name:"周毛毛",status:"agree",updatedAt:"2017-10-03  19:23:12",remark:"-"},{key:"op4",type:"提交订单",name:"林东东",status:"agree",updatedAt:"2017-10-03  19:23:12",remark:"很棒"}],operation3:[{key:"op2",type:"财务复审",name:"付小小",status:"reject",updatedAt:"2017-10-03  19:23:12",remark:"不通过原因"},{key:"op3",type:"部门初审",name:"周毛毛",status:"agree",updatedAt:"2017-10-03  19:23:12",remark:"-"}]}},filters:{statusFilter:function(e){var t={agree:"成功",reject:"驳回"};return t[e]},statusTypeFilter:function(e){var t={agree:"success",reject:"error"};return t[e]}},methods:{handleTabChange:function(e){this.tabActiveKey=e},tryThreadPool:function(e){Object.assign(this.threadPoolConfig,e)}}},h=p,f=(o("7b979"),Object(u["a"])(h,r,a,!1,null,"c058744e",null));t["default"]=f.exports},3152:function(e,t,o){},"432b":function(e,t,o){"use strict";o.d(t,"a",(function(){return i}));var r=o("5530"),a=o("5880"),i={computed:Object(r["a"])(Object(r["a"])({},Object(a["mapState"])({layout:function(e){return e.app.layout},navTheme:function(e){return e.app.theme},primaryColor:function(e){return e.app.color},colorWeak:function(e){return e.app.weak},fixedHeader:function(e){return e.app.fixedHeader},fixedSidebar:function(e){return e.app.fixedSidebar},contentWidth:function(e){return e.app.contentWidth},autoHideHeader:function(e){return e.app.autoHideHeader},isMobile:function(e){return e.app.isMobile},sideCollapsed:function(e){return e.app.sideCollapsed},multiTab:function(e){return e.app.multiTab}})),{},{isTopMenu:function(){return"topmenu"===this.layout}}),methods:{isSideMenu:function(){return!this.isTopMenu}}}},"7b979":function(e,t,o){"use strict";var r=o("3152"),a=o.n(r);a.a}}]);